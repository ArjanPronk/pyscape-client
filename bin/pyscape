#! /usr/bin/env/ python3

import sys
import json

from pyscape import Pyscape
from cli import *

urls = ['distilled.net','moz.com','cnn.com']

def batch_urls(urls, n):
    """n = size of batches. 10 is recommended."""
    for i in range(0, len(urls), n):
        yield urls[i:i+n]

def main():
    # args = build_parser().parse_args()

    # load API credentials
    with open('./keys.json', 'r') as k:
        keys = json.load(k)
        
    p = Pyscape(**keys)
    
    data = []
    for batch in batch_urls(urls, 2):
        data.extend(p.batch_url_metrics(batch).json())
    print(data)
    
    #url = 'distilled.net'
    #print(p.get_url_metrics(url).json())

if __name__ == '__main__':
    sys.exit(main())
